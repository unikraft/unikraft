/* SPDX-License-Identifier: BSD-3-Clause */
/* Copyright (c) 2023, Unikraft GmbH and The Unikraft Authors.
 * Licensed under the BSD-3-Clause License (the "License").
 * You may not use this file except in compliance with the License.
 */

#ifndef __UKARCH_SVM_H__
#define __UKARCH_SVM_H__

#define SVM_VMEXIT_CR0_READ		0x000
#define SVM_VMEXIT_CR1_READ		0x001
#define SVM_VMEXIT_CR2_READ		0x002
#define SVM_VMEXIT_CR3_READ		0x003
#define SVM_VMEXIT_CR4_READ		0x004
#define SVM_VMEXIT_CR5_READ		0x005
#define SVM_VMEXIT_CR6_READ		0x006
#define SVM_VMEXIT_CR7_READ		0x007
#define SVM_VMEXIT_CR8_READ		0x008

#define SVM_VMEXIT_CR0_WRITE		0x010
#define SVM_VMEXIT_CR1_WRITE		0x011
#define SVM_VMEXIT_CR2_WRITE		0x012
#define SVM_VMEXIT_CR3_WRITE		0x013
#define SVM_VMEXIT_CR4_WRITE		0x014
#define SVM_VMEXIT_CR5_WRITE		0x015
#define SVM_VMEXIT_CR6_WRITE		0x016
#define SVM_VMEXIT_CR7_WRITE		0x017
#define SVM_VMEXIT_CR8_WRITE		0x018

#define SVM_VMEXIT_DR0_READ		0x020
#define SVM_VMEXIT_DR1_READ		0x021
#define SVM_VMEXIT_DR2_READ		0x022
#define SVM_VMEXIT_DR3_READ		0x023
#define SVM_VMEXIT_DR4_READ		0x024
#define SVM_VMEXIT_DR5_READ		0x025
#define SVM_VMEXIT_DR6_READ		0x026
#define SVM_VMEXIT_DR7_READ		0x027
#define SVM_VMEXIT_DR8_READ		0x028

#define SVM_VMEXIT_DR0_WRITE		0x030
#define SVM_VMEXIT_DR1_WRITE		0x031
#define SVM_VMEXIT_DR2_WRITE		0x032
#define SVM_VMEXIT_DR3_WRITE		0x033
#define SVM_VMEXIT_DR4_WRITE		0x034
#define SVM_VMEXIT_DR5_WRITE		0x035
#define SVM_VMEXIT_DR6_WRITE		0x036
#define SVM_VMEXIT_DR7_WRITE		0x037
#define SVM_VMEXIT_DR8_WRITE		0x038

#define SVM_VMEXIT_EXCP_BASE		0x040
#define SVM_VMEXIT_EXCP_LAST		0x05f
#define SVM_VMEXIT_INTR			0x060
#define SVM_VMEXIT_NMI			0x061
#define SVM_VMEXIT_SMI			0x062
#define SVM_VMEXIT_INIT			0x063
#define SVM_VMEXIT_VINTR		0x064
#define SVM_VMEXIT_CR0_SEL_WRITE	0x065
#define SVM_VMEXIT_IDTR_READ		0x066
#define SVM_VMEXIT_GDTR_READ		0x067
#define SVM_VMEXIT_LDTR_READ		0x068
#define SVM_VMEXIT_TR_READ		0x069
#define SVM_VMEXIT_IDTR_WRITE		0x06a
#define SVM_VMEXIT_GDTR_WRITE		0x06b
#define SVM_VMEXIT_LDTR_WRITE		0x06c
#define SVM_VMEXIT_TR_WRITE		0x06d
#define SVM_VMEXIT_RDTSC		0x06e
#define SVM_VMEXIT_RDPMC		0x06f
#define SVM_VMEXIT_PUSHF		0x070
#define SVM_VMEXIT_POPF			0x071
#define SVM_VMEXIT_CPUID		0x072
#define SVM_VMEXIT_RSM			0x073
#define SVM_VMEXIT_IRET			0x074
#define SVM_VMEXIT_SWINT 		0x075
#define SVM_VMEXIT_INVD 		0x076
#define SVM_VMEXIT_PAUSE 		0x077
#define SVM_VMEXIT_HLT			0x078
#define SVM_VMEXIT_INVLPG		0x079
#define SVM_VMEXIT_INVLPGA		0x07a
#define SVM_VMEXIT_IOIO			0x07b
#define SVM_VMEXIT_MSR			0x07c
#define SVM_VMEXIT_TASK_SWITCH		0x07d
#define SVM_VMEXIT_FERR_FREEZE		0x07e
#define SVM_VMEXIT_SHUTDOWN      	0x07f
#define SVM_VMEXIT_VMRUN         	0x080
#define SVM_VMEXIT_VMMCALL       	0x081
#define SVM_VMEXIT_VMLOAD        	0x082
#define SVM_VMEXIT_VMSAVE        	0x083
#define SVM_VMEXIT_STGI          	0x084
#define SVM_VMEXIT_CLGI          	0x085
#define SVM_VMEXIT_SKINIT        	0x086
#define SVM_VMEXIT_RDTSCP        	0x087
#define SVM_VMEXIT_ICEBP         	0x088
#define SVM_VMEXIT_WBINVD        	0x089
#define SVM_VMEXIT_MONITOR       	0x08a
#define SVM_VMEXIT_MWAIT         	0x08b
#define SVM_VMEXIT_MWAIT_COND    	0x08c
#define SVM_VMEXIT_XSETBV        	0x08d
#define SVM_VMEXIT_RDPRU         	0x08e
#define SVM_VMEXIT_EFER_WRITE_TRAP	0x08f

#define SVM_VMEXIT_CR0_WRITE_TRAP	0x090
#define SVM_VMEXIT_CR1_WRITE_TRAP	0x091
#define SVM_VMEXIT_CR2_WRITE_TRAP	0x092
#define SVM_VMEXIT_CR3_WRITE_TRAP	0x093
#define SVM_VMEXIT_CR4_WRITE_TRAP	0x094
#define SVM_VMEXIT_CR5_WRITE_TRAP	0x095
#define SVM_VMEXIT_CR6_WRITE_TRAP	0x096
#define SVM_VMEXIT_CR7_WRITE_TRAP	0x097
#define SVM_VMEXIT_CR8_WRITE_TRAP	0x098
#define SVM_VMEXIT_CR9_WRITE_TRAP	0x099
#define SVM_VMEXIT_CR10_WRITE_TRAP	0x09a
#define SVM_VMEXIT_CR11_WRITE_TRAP	0x09b
#define SVM_VMEXIT_CR12_WRITE_TRAP	0x09c
#define SVM_VMEXIT_CR13_WRITE_TRAP	0x09d
#define SVM_VMEXIT_CR14_WRITE_TRAP	0x09e
#define SVM_VMEXIT_CR15_WRITE_TRAP	0x09f

#define SVM_VMEXIT_INVLPGB		0x0a0
#define SVM_VMEXIT_INVLPGB_ILLEGAL	0x0a0
#define SVM_VMEXIT_INVPCID		0x0a2
#define SVM_VMEXIT_MCOMMIT		0x0a3
#define SVM_VMEXIT_TLBSYNC		0x0a4
#define SVM_VMEXIT_BUSLOCK		0x0a5

#define SVM_VMEXIT_NPF			0x400
#define SVM_VMEXIT_AVIC_INCOMPLETE_IPI	0x401
#define SVM_VMEXIT_AVIC_NOACCEL		0x402
#define SVM_VMEXIT_VMGEXIT		0x403

/* SEV-ES exit flags*/
#define SVM_VMGEXIT_MMIO_READ		0x80000001
#define SVM_VMGEXIT_MMIO_WRITE		0x80000002
#define SVM_VMGEXIT_NMI_COMPLETE	0x80000003
#define SVM_VMGEXIT_AP_HLT_LOOP		0x80000004
#define SVM_VMGEXIT_AP_JUMP_TABLE	0x80000005
#define SVM_VMGEXIT_SET_AP_JUMP_TABLE	0
#define SVM_VMGEXIT_GET_AP_JUMP_TABLE	1
#define SVM_VMGEXIT_PSC			0x80000010
#define SVM_VMGEXIT_GUEST_REQUEST	0x80000011
#define SVM_VMGEXIT_EXT_GUEST_REQUEST	0x80000012
#define SVM_VMGEXIT_AP_CREATION		0x80000013
#define SVM_VMGEXIT_AP_CREATE_ON_INIT	0
#define SVM_VMGEXIT_AP_CREATE		1
#define SVM_VMGEXIT_AP_DESTROY		2
#define SVM_VMGEXIT_HV_FEATURES		0x8000fffd

#endif /* __UKARCH_SVM_H__ */
